# NEWS-AGGREGATOR

–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è https://tochka.com/ üôÉ

## –û–ü–ò–°–ê–ù–ò–ï

–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç –ø–∞—Ä—Å–∏—Ç—å:

* –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç—å–∏ —Å–∞–π—Ç–∞ https://habr.com/ru/
* –Ω–æ–≤–æ—Å—Ç–∏ —Å–∞–π—Ç–∞ https://hi-tech.news/

## –õ–û–ö–ê–õ–¨–ù–´–ô –ó–ê–ü–£–°–ö

    $ cd deployments
    $ docker compose up

## REST API

```http request
url: http://localhost:8086/
```

### POST /habr

–ó–∞–≥—Ä—É–∑–∫–∞ –≤ –±–∞–∑—É —Å—Ç–∞—Ç–µ–π –∏–ª–∏ –Ω–æ–≤–æ—Å—Ç–µ–π —Å —Ö–∞–±—Ä–∞. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∑–∞–¥–∞—é—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞:

```json
{
    "articles": true,
    "all": true,
    "scope": 10,
    "best": false,
    "period": 0
}
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏**

Param         | Value     | Description
---------     |--------   | -----------
**articles**  | **bool**  | **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π. –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —á—Ç–æ —Å–æ–±–∏—Ä–∞—Ç—å**
`             | true      | –±—É–¥—É—Ç —Å—Ç–∞—Ç—å–∏ —Å —Å–∞–π—Ç–∞
`             | false     | –±—É–¥—É—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ —Å —Å–∞–π—Ç–∞
**all**       | **bool**  | **–Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏. —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å–ª–∏ articles = true –∏ best = false**
`             | true      | 
`             | false     |  
**rating**    | **uint**  | **–æ—Ü–µ–Ω–∫–∞ —Å—Ç–∞—Ç—å–∏. –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å, —Ç–æ–≥–¥–∞ –ø–∞—Ä—Å–µ—Ä –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å —Ä–∞–Ω–¥–æ–º–Ω—ã–µ —Å—Ç–∞—Ç—å–∏**
`             | 10        | –≤—ã—à–µ 10
`             | 25        | –≤—ã—à–µ 25 
`             | 50        | –≤—ã—à–µ 50 
`             | 100       | –≤—ã—à–µ 100  
`             | empty     | –±–µ–∑ –ø–æ—Ä–æ–≥–∞            
**best**      | **bool**  | **–ª—É—á—à–∏–µ —Å—Ç–∞—Ç—å–∏. —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å–ª–∏ articles = true –∏ all = false** 
`             | true      |        
`             | false     |                                                      
**period**    | **string**| **–ø–µ—Ä–∏–æ–¥ –≤ —Ç–æ–ø–µ**
`             | "day"     | —Å—É—Ç–∫–∏
`             | "week"    | –Ω–µ–¥–µ–ª—è 
`             | "month"   | –º–µ—Å—è—Ü
`             | "year"    | –≥–æ–¥ 
`             | empty     | –≤—ã–≤–µ–¥–µ—Ç—Å—è –∑–∞ —Å—É—Ç–∫–∏   

**Return values**  
```json
{
    "data": {
        "message": "Habr's site data was parsed and saved"
    }
}
```

### GET /habr?limit=3&offset=1

–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ –±–∞–∑—ã.

**Return values**  
```json
{
    "data": [
        {
            "id": "e0a01eb0-40e4-481a-9304-de0ed5a1cad5",
            "author": "AnnieBronson",
            "author_link": "https://habr.com/ru/users/AnnieBronson/",
            "title": "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑—É–º–±–æ–º–±–∏–Ω–≥–∞ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –∫–æ–Ω—Ç—Ä–º–µ—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–µ –¥–∞—é—Ç",
            "views": "2,7k",
            "publication_date": "–≤—á–µ—Ä–∞ –≤ 10:53",
            "link": "https://habr.com/ru/news/t/541008/",
            "created_at": "2021-02-06T21:06:48.099648Z"
        },
        {
            "id": "627dbe1b-2791-4b25-a79c-ad8190be7152",
            "author": "AnnieBronson",
            "author_link": "https://habr.com/ru/users/AnnieBronson/",
            "title": "Google –¥–æ–±–∞–≤–∏—Ç –≤ —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ã Pixel —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—É–ª—å—Å–∞: –ø–∞–ª–µ—Ü –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–ª–æ–∂–∏—Ç—å –∫ –∫–∞–º–µ—Ä–µ",
            "views": "2,5k",
            "publication_date": "–≤—á–µ—Ä–∞ –≤ 11:33",
            "link": "https://habr.com/ru/news/t/541022/",
            "created_at": "2021-02-06T21:06:48.094766Z"
        },
        {
            "id": "f1bc2db3-68df-410b-8101-f9f3f993e788",
            "author": "avouner",
            "author_link": "https://habr.com/ru/users/avouner/",
            "title": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ë–∞–π–¥–µ–Ω–∞ –ø–æ–æ–±–µ—â–∞–ª–∞ –Ω–µ —Å–Ω–∏–º–∞—Ç—å —Å–∞–Ω–∫—Ü–∏–∏ —Å Huawei –∏ –¥—Ä—É–≥–∏—Ö –∫–∏—Ç–∞–π—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π",
            "views": "1,6k",
            "publication_date": "–≤—á–µ—Ä–∞ –≤ 11:57",
            "link": "https://habr.com/ru/news/t/541026/",
            "created_at": "2021-02-06T21:06:48.092152Z"
        }
    ]   
}
```

### GET /habr/search?title=–ö–∞–∫ —Å–∂–∞—Ç—å

–ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ.

**Return values**  
```json
{
    "data": [
        {
            "id": "d3d5f9e1-3523-4104-8dca-0e5c2a926360",
            "author": "BlackBox",
            "author_link": "https://habr.com/ru/users/BlackBox/",
            "title": "–ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –∏–ª–∏ –ö–∞–∫ —Å–∂–∞—Ç—å –ø–æ–ª—Ç–æ—Ä–∞ –≥–∏–≥–∞–±–∞–π—Ç–∞ –¥–æ 42 –º–µ–≥–∞–±–∞–π—Ç",
            "views": "12,2k",
            "publication_date": "–≤—á–µ—Ä–∞ –≤ 12:52",
            "link": "https://habr.com/ru/post/538358/",
            "created_at": "2021-02-06T09:01:58.483185Z"
        }
    ]
}
```

### POST /hi_tech_news

–ó–∞–≥—Ä—É–∑–∫–∞ –≤ –±–∞–∑—É —Å—Ç–∞—Ç–µ–π –∏–ª–∏ –Ω–æ–≤–æ—Å—Ç–µ–π —Å hi-tech news. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∑–∞–¥–∞—é—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞:

```json
{
    "category": "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
    "page": 2
}
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏**

Param         | Value         | Description
---------     | ------------- | -----------
**category**  | **string**    | **–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å–æ–±–∏—Ä–∞—Ç—å**
`             | "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã"   | 
`             | "–ú–µ–¥–∏—Ü–∏–Ω–∞"    |        
`             | "–ü—Ä–æ—á–µ–µ"      | 
`             | empty         | _P.S.: –ö–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ —Å–∞–π—Ç–µ –±–æ–ª—å—à–µ, —è –≤–∑—è–ª–∞ —ç—Ç–∏ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ_         
**page**      | **uint**      | **–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–∞—Ä—Å–∏—Ç—å**
`             | –æ—Ç 1 –¥–æ 90    | 

**Return values**  
```json
{
    "data": {
        "message": "Hi-tech's site data was parsed and saved"
    }
}
```

### GET /hi_tech_news?limit=3&offset=1

–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ –±–∞–∑—ã.

**Return values**  
```json
{
    "data": [
        {
            "id": "c9e9ca43-a273-4421-9c0c-3c1a897b5b64",
            "category": "–¢–µ–ª–µ–≤–∏–∑–æ—Ä—ã",
            "title": "Philips –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä—ã —Å–µ—Ä–∏–∏ 9000 Mini LED. –û—Å–æ–±—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –æ–∂–∏–¥–∞–µ—Ç—Å—è –æ—Ç –≥–µ–π–º–µ—Ä–æ–≤",
            "preview": "–£–∂–µ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω—ã –ø–æ—Å—Ç—É–ø—è—Ç –ø–µ—Ä–≤—ã–µ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä—ã Philips, –æ—Å–Ω–∞—â–µ–Ω–Ω—ã–µ –º–∏–Ω–∏-—Å–≤–µ—Ç–æ–¥–∏–æ–¥–Ω—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ ‚Äì Mini LED. –°–µ—Ä–∏—è 9000 —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –≥–µ–π–º–µ—Ä–æ–≤ –∏ —É–ª—É—á—à–µ–Ω–Ω—É—é...",
            "link": "https://hi-tech.news/tv/2683-philips-predstavila-televizory-serii-9000-mini-led-osobyj-interes-ozhidaetsja-ot-gejmerov.html",
            "created_at": "2021-02-06T20:06:05.007291Z"
        },
        {
            "id": "aa5d81a6-4400-4d31-b123-e5251f5490f3",
            "category": "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
            "title": "–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø—Ä–µ–º—å–µ—Ä–∞ Xiaomi Mi 11 –∏ MIUI 12.5 –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ 8 —Ñ–µ–≤—Ä–∞–ª—è",
            "preview": "–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤ –ö–∏—Ç–∞–µ Xiaomi Mi 11 –≥–æ—Ç–æ–≤ –≤—ã–π—Ç–∏ –Ω–∞ –º–∏—Ä–æ–≤–æ–π —Ä—ã–Ω–æ–∫ ‚Äì —ç—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç 8 —Ñ–µ–≤—Ä–∞–ª—è. –û–¥–Ω–∞–∫–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ Mi 11 Pro –ø–æ–∫–∞ –Ω–µ—Ç. –ù–æ —ç—Ç–æ –Ω–µ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–µ–º—å–µ—Ä–∞ –Ω–æ–≤–æ–≥–æ...",
            "link": "https://hi-tech.news/smartphone/2689-globalnaja-premera-xiaomi-mi-11-i-miui-125-zaplanirovany-na-8-fevralja.html",
            "created_at": "2021-02-06T20:06:05.004547Z"
        },
        {
            "id": "037ad1d2-5326-4275-a051-db8471c9a3af",
            "category": "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç",
            "title": "–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Telegram –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–ø–∏—Å–∫–∏ —Å –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π",
            "preview": "Telegram v7.4.0 —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–æ–≤ –∏–∑ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ WhatsApp, Line –∏ KakaoTalk. –≠—Ç–æ—Ç —à–∞–≥ –ø–æ—Å–ª–µ–¥–æ–≤–∞–ª –ø–æ—Å–ª–µ —Å–ø–æ—Ä–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è...",
            "link": "https://hi-tech.news/internet/2690-poslednee-obnovlenie-telegram-pozvoljaet-importirovat-istoriju-perepiski-s-drugih-prilozhenij.html",
            "created_at": "2021-02-06T20:06:05.002304Z"
        }
    }
]
```

### GET /hi_tech_news/search?title=COVID

–ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ.

**Return values**  
```json
{
    "data": [
        {
            "id": "4080e8e2-150e-485c-a109-ecaa6a13e626",
            "category": "–ú–µ–¥–∏—Ü–∏–Ω–∞",
            "title": "COVID Hunter ‚Äì –±–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Å–∫–∞–Ω–µ—Ä –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–æ—Ä–æ–Ω–∞–≤–∏—Ä—É—Å–∞ (–≤–∏–¥–µ–æ)",
            "preview": "–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è Advanced Medical Solutions International –∑–∞—è–≤–∏–ª–∞, —á—Ç–æ –∏–∑–æ–±—Ä–µ–ª–∞ –ø–µ—Ä–≤—ã–π –≤ –º–∏—Ä–µ –±–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Å–∫–∞–Ω–µ—Ä –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–æ—Ä–æ–Ω–∞–≤–∏—Ä—É—Å–∞ —Å 99-–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é. –¢–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π...",
            "link": "https://hi-tech.news/med/2705-covid-hunter-beskontaktnyj-skaner-dlja-obnaruzhenija-koronavirusa-video.html",
            "created_at": "2021-02-06T09:02:13.705096Z"
        }
    ]
}
```

### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–¥. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 500 status code, –µ—Å–ª–∏ –Ω–µ—Ç —Å–≤—è–∑–∏ —Å –±–¥.   

## Environments Variables
   
   Variable             | Description
   ------------------   | -----------
   APP_NAME             | –ò–º—è —Å–µ—Ä–≤–∏—Å–∞
   HTTP_SERVER_PORT     | –ü–æ—Ä—Ç http —Å–µ—Ä–≤–µ—Ä–∞
   DB_USER              | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö 
   DB_PASS              | –ü–∞—Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   DB_HOST              | –ê–¥—Ä–µ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   DB_PORT              | –ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   DB_NAME              | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   DB_MAX_CONNS         | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ –ø—É–ª–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 32)
   DB_MAX_LIFETIME      | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5m)
   DB_TIMEOUT           | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30s)
   DB_RETRIES           | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)
   LOGGER_ADDRESS       | UDP –∞–¥—Ä–µ—Å –ª–æ–≥–≥–µ—Ä–∞
   LOGGER_LEVEL         | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ [TRACE, DEBUG, INFO, WARN, ERROR, FATAL, PANIC] (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é INFO)
   LOGGER_POD_NAME      | kube pod
   LOGGER_POD_NODE      | kube node
   LOGGER_POD_NAMESPACE | kube pod namespace